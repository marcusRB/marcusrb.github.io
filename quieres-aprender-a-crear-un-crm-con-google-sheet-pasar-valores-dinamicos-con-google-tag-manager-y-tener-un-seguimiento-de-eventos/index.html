<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  <title>Realizar un CRM con Google Spreadsheets con Google Tag Manager | MarcusRB</title>
    


  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Marco Russo">

  
  <meta name="robots" content="index, follow">

  
  
  
    
  
  <meta name="description" content="Google Tag Manager es una de las herramientas más innovadoras en la gestión avanzada de nuestro análisis de marketing">

  
  <link rel="alternate" hreflang="en-us" href="https://www.marcusrb.com/quieres-aprender-a-crear-un-crm-con-google-sheet-pasar-valores-dinamicos-con-google-tag-manager-y-tener-un-seguimiento-de-eventos/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:200,500|Merriweather:200,300|Roboto+Mono:300,400&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.561c2ba69cc8c6babcfc0393b003a821.css">

  

  
  
  

  
  
    
    
    <script>
      var dataLayer = window.dataLayer = window.dataLayer || [];
      dataLayer.push({
        page:'Realizar un CRM con Google Spreadsheets con Google Tag Manager',
        categories:''
      });
    </script>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MPFRNJ');</script>


    
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://www.marcusrb.com/quieres-aprender-a-crear-un-crm-con-google-sheet-pasar-valores-dinamicos-con-google-tag-manager-y-tener-un-seguimiento-de-eventos/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@rb_marcus">
  <meta property="twitter:creator" content="@rb_marcus">
  
  <meta property="og:site_name" content="MMarcusRB | consultor &amp; profesor data analytics • AI • Big Data">
  <meta property="og:url" content="https://www.marcusrb.com/quieres-aprender-a-crear-un-crm-con-google-sheet-pasar-valores-dinamicos-con-google-tag-manager-y-tener-un-seguimiento-de-eventos/">
  <meta property="og:title" content="Realizar un CRM con Google Spreadsheets con Google Tag Manager | MMarcusRB | consultor &amp; profesor data analytics • AI • Big Data">
  <meta property="og:description" content="Google Tag Manager es una de las herramientas más innovadoras en la gestión avanzada de nuestro análisis de marketing"><meta property="og:image" content="https://www.marcusrb.com/img/img/2018/05/CRM-Google-Sheet-GTM-260x146.png">
  <meta property="twitter:image" content="https://www.marcusrb.com/img/img/2018/05/CRM-Google-Sheet-GTM-260x146.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2018-05-02T13:32:16&#43;00:00">
    
    <meta property="article:modified_time" content="2019-05-28T23:49:24&#43;02:00">
  

  


  





</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  
  



    <noscript>
      <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MPFRNJ" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>

  


  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Buscar</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Buscar..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
      <a class="navbar-brand" href="/">MarcusRB</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Barra de navegación">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Inicio</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/servicios"><span>Servicios</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses"><span>Cursos</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/resources"><span>Recursos</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contactos</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  









<div class="article-header">
  
  
  <img src="/img/img/2018/05/CRM-Google-Sheet-GTM-260x146.png" class="article-banner" itemprop="image" alt="">
  

  
</div>




  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Realizar un CRM con Google Spreadsheets con Google Tag Manager</h1>

  

  
    



<meta content="2018-05-02 13:32:16 &#43;0000 &#43;0000" itemprop="datePublished">
<meta content="2019-05-28 23:49:24 &#43;0200 CEST" itemprop="dateModified">

<div class="article-metadata">

  
  
  
  
  <div>
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><a href="/authors/marcusrb/">marcusRB</a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
          Última actualización el
      
    
    <time>May 28, 2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min de lectura
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/tag-manager/">Tag Manager</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://www.marcusrb.com/quieres-aprender-a-crear-un-crm-con-google-sheet-pasar-valores-dinamicos-con-google-tag-manager-y-tener-un-seguimiento-de-eventos/&amp;text=Realizar%20un%20CRM%20con%20Google%20Spreadsheets%20con%20Google%20Tag%20Manager" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://www.marcusrb.com/quieres-aprender-a-crear-un-crm-con-google-sheet-pasar-valores-dinamicos-con-google-tag-manager-y-tener-un-seguimiento-de-eventos/&amp;t=Realizar%20un%20CRM%20con%20Google%20Spreadsheets%20con%20Google%20Tag%20Manager" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Realizar%20un%20CRM%20con%20Google%20Spreadsheets%20con%20Google%20Tag%20Manager&amp;body=https://www.marcusrb.com/quieres-aprender-a-crear-un-crm-con-google-sheet-pasar-valores-dinamicos-con-google-tag-manager-y-tener-un-seguimiento-de-eventos/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://www.marcusrb.com/quieres-aprender-a-crear-un-crm-con-google-sheet-pasar-valores-dinamicos-con-google-tag-manager-y-tener-un-seguimiento-de-eventos/&amp;title=Realizar%20un%20CRM%20con%20Google%20Spreadsheets%20con%20Google%20Tag%20Manager" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Realizar%20un%20CRM%20con%20Google%20Spreadsheets%20con%20Google%20Tag%20Manager%20https://www.marcusrb.com/quieres-aprender-a-crear-un-crm-con-google-sheet-pasar-valores-dinamicos-con-google-tag-manager-y-tener-un-seguimiento-de-eventos/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://www.marcusrb.com/quieres-aprender-a-crear-un-crm-con-google-sheet-pasar-valores-dinamicos-con-google-tag-manager-y-tener-un-seguimiento-de-eventos/&amp;title=Realizar%20un%20CRM%20con%20Google%20Spreadsheets%20con%20Google%20Tag%20Manager" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      

<h2 id="quiéres-aprender-a-crear-un-crm-con-google-sheet-pasar-valores-dinámicos-con-google-tag-manager-y-tener-un-seguimiento-de-eventos">¿Quiéres aprender a crear un CRM con Google Sheet, pasar valores dinámicos con Google Tag Manager y tener un seguimiento de eventos?</h2>

<p>Será un tutorial dividido en dos partes, la primera la explicación de como crear en Tag Manager variables, personalizadas y dinámicas, ejemplo al enviar un formulario para Leads, y de otro lado enlazando Google Sheet y tener toda la información (excluyo la información sensible en virtud de la nueva ley GDPR no haré mención a datos sensibles), además a tener en cuenta que tampoco llevaré estos datos a Google Analytics para evitar penalizaciones (nunca me ha pasado y tampoco quiero arriesgarme). Pronto también el vídeo con el tutorial, esté atento en mi <a href="https://www.youtube.com/c/MarcusRBofficial?sub_confirmation=1" target="_blank">canal YouTube</a></p>

<h3 id="preparando-las-variables-en-google-tag-manager">Preparando las variables en Google Tag Manager</h3>

<p>Antes de empezar, hay que tener en cuenta unos cuantos puntos, si eres nuevo en Google Tag Manager, seguramente llegarás a final de este párrafo y te irás llorando, porque hablaré de Tag Manager a nivel más avanzado. En caso de dudas sobre etiquetas, variables e incluso el mismo Tag Manager, te recomiendo hagas una <a href="https://www.youtube.com/watch?v=MAn20Yi62z8&amp;t=437s&amp;list=PLzxNDhvkuNyIy7mMAZl_wItUW3CWDx8pD&amp;index=5" target="_blank">primera visita aquí. </a></p>

<p>Si ya estás acostumbrado a extraer informaciones a nivel más avanzado, y conoce de DOM, HTML y CSS, además de JavaScript, entonces, bienvenido.</p>

<p>Comenzaré hablar de como tener un cuadro de seguimiento, y podría ampliar más informaciones y campos, pero me conformo con este CRM básico</p>

<p><a href="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.31.png" target="_blank"><img class="aligncenter wp-image-498 size-full" src="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.31.png" alt="CRM en Google Sheets" width="710" height="521" srcset="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.31.png 710w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.31-300x220.png 300w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.31-199x146.png 199w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.31-50x37.png 50w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.31-102x75.png 102w" sizes="(max-width: 710px) 100vw, 710px" /></a></p>

<p>Segundo paso tengo este formulario básico de momento justo para alinearme a mi CRM y luego explicaré como ampliar con más informaciones y detalles</p>

<p><a href="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.46.png" target="_blank"><img class="aligncenter wp-image-499 size-full" src="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.46.png" alt="Formulario sitio web sencillo" width="481" height="391" srcset="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.46.png 481w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.46-300x244.png 300w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.46-180x146.png 180w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.46-50x41.png 50w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.49.46-92x75.png 92w" sizes="(max-width: 481px) 100vw, 481px" /></a></p>

<p>Para extraer informaciones desde un DOM, es necesario tener bien claro una cosa, realizar lo siguiente:</p>

<p style="text-align: center;">
  consola de desarrollador > pruebas con ID, clases o Selector CSS > aplicar a más de uno y hacer pruebas
</p>

<p>Una vez que tengamos los campos necesario para extraer los valores de los campos del formulario, podemos inclusive determinar otras KPI&#8217;s importantes y útiles:</p>

<ul>
<li>abandono del formulario</li>
<li>creación de un funnel y determinar los porcentajes de campos no rellenados vs completo</li>
<li>tiempo de permanencia en el formulario y medición de duración en segundos desde el primer click hasta el envío</li>
<li>test A/B en el mismo con diferentes opciones y determinar cuál de los formularios mejora el %ratio de conversión</li>
<li>etc&#8230;</li>
</ul>

<p>&nbsp;</p>

<h3 id="entramos-ahora-con-el-concepto-de-extraer-la-información-en-una-alerta-de-consola-y-ver-los-valores">Entramos ahora con el concepto de extraer la información en una alerta de consola y ver los valores</h3>

<p>Una vez dentro de nuestro Tag Manager vamos con la creación de nuestras variables, primero ha de comprobar los campos del formulario (si existen ID, clases o selector CSS), y ver su activador de tipo bóton de envío formulario (tipo HTML, jQuery o Ajax, modal, iframe, etc).</p>

<h4 id="creación-de-la-variables"><strong>Creación de la variables</strong></h4>

<p>Este es el código fuente de mi formulario:</p>

<p><a href="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.56.28.png" target="_blank"><img class="aligncenter wp-image-501 size-full" src="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.56.28.png" alt="código fuente formulario HTML" width="888" height="569" srcset="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.56.28.png 888w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.56.28-300x192.png 300w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.56.28-768x492.png 768w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.56.28-228x146.png 228w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.56.28-50x32.png 50w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.56.28-117x75.png 117w" sizes="(max-width: 888px) 100vw, 888px" /></a></p>

<p>Y este es como veo los campos DOM en la Consola de Google Chrome:</p>

<p><a href="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.57.57.png" target="_blank"><img class="aligncenter wp-image-502 size-full" src="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.57.57.png" alt="DOM formulario con querySelectorAll" width="988" height="891" srcset="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.57.57.png 988w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.57.57-300x271.png 300w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.57.57-768x693.png 768w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.57.57-162x146.png 162w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.57.57-50x45.png 50w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-22.57.57-83x75.png 83w" sizes="(max-width: 988px) 100vw, 988px" /></a></p>

<p>Ahora bien que tengo los campos de nombre, apellidos, dirección, género, email y comentarios, incluido botones de enviar y resetear, iré a lo práctico.</p>

<p style="text-align: left;">
  Crearé las variables de tipo Javascript Personalizado y veámos como función la vista previa para el primer campo NAME.<br /> Si para extraer el valor en el campo, la query será:
</p>

<p style="text-align: center;">
  <pre>document.querySelectorAll('[id=classicForm]')[0][0].value</pre>
</p>

<p>Resultado:</p>

<p><a href="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.06.14.png" target="_blank"><img class="aligncenter size-large wp-image-503" src="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.06.14-1024x373.png" alt="" width="1024" height="373" srcset="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.06.14-1024x373.png 1024w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.06.14-300x109.png 300w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.06.14-768x280.png 768w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.06.14-260x95.png 260w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.06.14-50x18.png 50w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.06.14-150x55.png 150w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.06.14.png 1175w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p>Ahora bien, mi CRM puedo rellenar de valores cuáles, también datos personales y sensibles, así que me limitaré a asignarle solo valores booleanos: TRUE o FALSE, siempre y cuando la condición será &gt; enviar el formulario rellenado y no vacío.</p>

<p>el código así reescrito es:</p>

<p><a href="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.13.06.png" target="_blank"><img class="aligncenter wp-image-504 size-large" src="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.13.06-1024x494.png" alt="" width="1024" height="494" srcset="https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.13.06-1024x494.png 1024w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.13.06-300x145.png 300w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.13.06-768x370.png 768w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.13.06-260x125.png 260w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.13.06-50x24.png 50w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.13.06-150x72.png 150w, https://www.marcusrb.com/img/2018/05/Captura-de-pantalla-2018-05-02-a-las-23.13.06.png 1273w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p>###</p>

<p>En práctica asigno una variable a mi selector, primer campo y lo confronto con un valor vacío <strong>&#8221; &#8220;</strong>, si no es así, entonces el valor de retorno será TRUE sino será FALSE.</p>

<p>Cuídado, el valor por defecto es UNDEFINED, porque no está asociado a ningún activador, así que siempre tendré en cuenta que el formulario será enviado (para su validación total).</p>

<p>&nbsp;</p>

<p><strong>MODO AVANZADO</strong></p>

<p>También puedo crear una variable que directamente hará el trabajo de validación y con este script le digo de sacarme el valor <strong>V</strong><strong>erdadero:</strong></p>

<p>En cada elemento tendré el parámetro <strong>Validity </strong>y según sea un campo obligatorio o no, tendré varias opciones</p>

<p><a href="https://www.marcusrb.com/img/2018/05/Screen-Shot-2018-05-04-at-10.09.12-PM.png" target="_blank"><img class="aligncenter size-full wp-image-511" src="https://www.marcusrb.com/img/2018/05/Screen-Shot-2018-05-04-at-10.09.12-PM.png" alt="" width="268" height="231" srcset="https://www.marcusrb.com/img/2018/05/Screen-Shot-2018-05-04-at-10.09.12-PM.png 268w, https://www.marcusrb.com/img/2018/05/Screen-Shot-2018-05-04-at-10.09.12-PM-169x146.png 169w, https://www.marcusrb.com/img/2018/05/Screen-Shot-2018-05-04-at-10.09.12-PM-50x43.png 50w, https://www.marcusrb.com/img/2018/05/Screen-Shot-2018-05-04-at-10.09.12-PM-87x75.png 87w" sizes="(max-width: 268px) 100vw, 268px" /></a></p>

<p>Así que resumiendo nuevamente tenemos:</p>

<p style="text-align: center;">
  <pre>document.querySelectorAll('[id=classicForm]')[0]</pre>
</p>

<p>y siguiendo puedo extender con la validación</p>

<p style="text-align: center;">
  <pre>document.querySelectorAll('[id=classicForm]')[0][0].validity.valid</pre>
</p>

<p>y esto me dará el resultado <strong>TRUE </strong>o <strong>FALSE</strong></p>

<p>Ahora hacemos lo mismo para todos los campos interesados:</p>

<p><em>Nombre, Apellidos, Dirección, Género, Email, Comentarios.</em></p>

<p>Solo necesitamos replicar al igual que el campo &#8220;nombre&#8221; los demás que quedan, ya que todos los campos de textos son de igual tipologia, serán exactamente iguales que el primer ejemplo, solo que tenemos que pasar de [0][0] <strong>a [0][1]</strong> y así hasta llegar al campo <strong>[0][5]</strong></p>

<p>&nbsp;</p>

<h3 id="creamos-la-etiqueta-y-activador">Creamos la etiqueta y activador</h3>

<p>Pasamos de crear las variables de los campos del formulario, y necesitaríamos el activador, en este ejemplo, mi formulario, tiene <em>onsubmit=ValidationEvent() </em>, en tu caso puede que el submit tenga una ID o una CLASS, o que el formulario esté creado con jQuery, así que vamos por lo más sencillo.</p>

<p><img activador></p>

<p>Mi ejemplo es un <strong>Evento Personalizado </strong>del tipo Submit con el valor <strong>ValidationEvent()</strong> y todo lo que necesito es enviar la información recogida hacía Google Sheets.</p>

<p>Sí, falta algo, crear un <strong>conector </strong>entre Google Tag Manager y Google Sheets, y para ello utilizo una etiqueta tipo <strong>PIXEL, </strong>que en su defecto sería la etiqueta <strong>Imagen</strong></p>

<p><img etiqueta imagen personalizada></p>

<p>El conector que vamos a crear es con <strong>Google Apps Script. </strong></p>

<p>Entramos en Google Drive &gt; Herramientas &gt; Editor de secuencias de comandos y creamos el script personalizado:</p>

<p><img código> que pueden descargar aquí</p>

<p style="text-align: center;">
  <pre>Insert your content here</pre>
</p>

<p style="text-align: left;">
  Muy importante cambiar los dos primeros valores:
</p>

<p><li style="text-align: left;">
  SHEET_NAME: nombre de la hoja donde tenemos los campos a rellenar (en mi ejemplo se llama <strong>Sheet1</strong>)
</li>
<li style="text-align: left;">
  SHEET_KEY: El valor ID de la hoja de cálculo lo que sigue /d/XXXXXXXXXXXX sería a rellenar
</li></p>

<p>Ahora solo hace falta Guardar &gt; Publicar &gt; Publicar como aplicación Web</p>

<p>Importante seleccionar el nivel de acceso a todos. Copiamos el código del script y seguimos</p>

<p><img script></p>

<p>&nbsp;</p>

<h3 id="creamos-la-variable-de-google-apps-script-en-tag-manager">Creamos la variable de Google Apps Script en Tag Manager</h3>

<p>Seguimos con la creación de la etiqueta Pixel, o imágen personalizada añadiendo la variable <strong>conector.</strong></p>

<p>Definimos la variable de tipo <strong>Constante </strong>con este valor Google Apps Script, y volvemos a la etiqueta</p>

<p><img></p>

<p><img></p>

<p>el código tendrá esta estructura</p>

<p style="text-align: center;">
  {{var_SCRIPT_GOOGLE_APPS}}<strong>?</strong>nombre_campo1={{var_1}}<strong>&</strong>nombre_campo_2={{var_2}} etc etc
</p>

<p> Si nos fijamos, el primer campo es la constante con la url de Google Apps Script, separamos con un <strong>? </strong>y seguimos con los mismos nombres de la primera linea de Google Sheets (si tenemos NAME será NAME y si será NOMBRE entonces pondríamos NOMBRE,) si fallamos esta parte no leerá la correspondencia entre los nombre de las primera file de Google Sheets con las variables donde hacer pasar los valores.</p>

<p>Ejemplo?</p>

<p>Para comprobar su correcto funcionamiento podemos hacer lo siguiente:</p>

<p>una ruta nueva con la URL de Google Apps Script y la secuencia</p>

<p><img></p>

<p>Resultado?</p>

<h3 id="img"><img></h3>

<p><img></p>

<p>&nbsp;</p>

<h3 id="vista-previa-y-publicación-testing">Vista previa y Publicación: Testing</h3>

<p>Vamos con la vista previa y si todo funciona correctamente tendremos valores TRUE y FALSE en nuestro CRM, o los valores correspondientes en caso de no tener que pasar por la validación Booleana.</p>

<p>El orden de los valores que siguen después <strong>&amp; </strong>es indiferente, siempre será una concatenación y los valores se pondrán en su sitio correspondiente en la hoja de cálculo.</p>

<p>&nbsp;</p>

<p>###</p>

<p>###</p>

<p>###</p>

<p>###</p>

<p>###</p>

<p>###</p>

<p>###</p>

<h3 id="aquí-el-webinar-sobre-como-crear-un-crm-y-pasar-las-variables-dinámicas-desde-google-tag-manager-a-nuestro-google-sheets">Aquí el webinar sobre como crear un CRM y pasar las variables dinámicas desde Google Tag Manager a nuestro Google Sheets</h3>

<p style="text-align: center;">
  <iframe src="https://www.youtube.com/embed/K_kV-_2CmZQ?rel=0" width="560" height="315" frameborder="0" allowfullscreen="allowfullscreen"></iframe>
</p>

    </div>

    


    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/integrar-google-script-apps-tag-manager/">integrar google script apps tag manager</a>
  
  <a class="badge badge-light" href="/tags/extraer-informacion-de-formularios-a-google-tag-manager/">extraer información de formularios a google tag manager</a>
  
  <a class="badge badge-light" href="/tags/pasar-valores-dinamicos-a-google-sheet/">pasar valores dinámicos a google sheet</a>
  
  <a class="badge badge-light" href="/tags/integrar-google-script-apps-tag-manager/">integrar google script apps tag manager</a>
  
</div>



    
      








  
  
    
  
  





  
  
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/authors/marcusrb/"></a></h5>
      
      
      <ul class="network-icon" aria-hidden="true">
        
      </ul>
    </div>
  </div>



      
      
    

    
    <div class="article-widget">
      
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Siguiente</div>
    <a href="/google-tag-manager-10-buenas-razones-para-usarlo-bien/" rel="next">Google Tag Manager: 10 buenas razones para usarlo bien</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Anterior</div>
    <a href="/realizando-auditoria-y-optimizacion-adwordsreparacion-moviles/" rel="prev">Realizando auditoría y optimización AdWords:Reparación Móviles</a>
  </div>
  
</div>

    </div>
    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.0.0/mermaid.min.js" integrity="sha256-0w92bcB21IY5+rGI84MGj52jNfHNbXVeQLrZ0CGdjNY=" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Buscar...",
        'results': "resultados encontrados",
        'no_results': "No se encontraron resultados"
      };
      const content_type = {
        'post': "Posts",
        'project': "Proyectos",
        'publication' : "Publicaciones",
        'talk' : "Charlas"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.4e51017b38c7ebaadd7e25fc9503f88c.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    &copy; 2020 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Citar</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copiar
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Descargar
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
