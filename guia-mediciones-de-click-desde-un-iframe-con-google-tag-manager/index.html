<!DOCTYPE html>
<html lang="es-ES">
<head>
  
  <title>[Guía] Mediciones de click desde un iframe con Google Tag Manager | MarcusRB</title>
    
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 2.4.0">
  <meta name="generator" content="Hugo 0.49.2" />
  <meta name="author" content="MarcusRB">

  
  
  
  
    
  
  <meta name="description" content="Un post sobre la medición de eventos, cuales clicks, conversiones, formularios, transacciones desde un iframe con Google Tag Manager.">
  <meta name="robots" content="index, follow">
  
  <link rel="alternate" hreflang="es-ES" href="https://www.marcusrb.com/guia-mediciones-de-click-desde-un-iframe-con-google-tag-manager/">

  


  

  

  

  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" crossorigin="anonymous">
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href=//fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono>
  

  <link rel="stylesheet" href="/styles.css">
  

  
  
  
  
  
  
  <script>
    var dataLayer = window.dataLayer = window.dataLayer || [];
    dataLayer.push({
      page:'[Guía] Mediciones de click desde un iframe con Google Tag Manager',
      categories:''
    });
  </script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-MPFRNJ');</script>
  
  
  
  <link rel="alternate" href="https://www.marcusrb.com/index.xml" type="application/rss+xml" title="MarcusRB: consultor &amp; docente Analítica de Datos">
  <link rel="feed" href="https://www.marcusrb.com/index.xml" type="application/rss+xml" title="MarcusRB: consultor &amp; docente Analítica de Datos">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://www.marcusrb.com/guia-mediciones-de-click-desde-un-iframe-con-google-tag-manager/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@rb_marcus">
  <meta property="twitter:creator" content="@rb_marcus">
  
  <meta property="og:site_name" content="MarcusRB: consultor &amp; docente Analítica de Datos">
  <meta property="og:url" content="https://www.marcusrb.com/guia-mediciones-de-click-desde-un-iframe-con-google-tag-manager/">
  <meta property="og:title" content="[Guía] Mediciones de click desde un iframe con Google Tag Manager | MarcusRB: consultor &amp; docente Analítica de Datos">
  <meta property="og:description" content="Un post sobre la medición de eventos, cuales clicks, conversiones, formularios, transacciones desde un iframe con Google Tag Manager.">
  
  
    
  <meta property="og:image" content="https://www.marcusrb.com/img/icon-192.png">
  <meta property="og:locale" content="es-ES">
  
  <meta property="article:published_time" content="2018-06-30T08:26:33&#43;00:00">
  
  <meta property="article:modified_time" content="2018-06-30T08:26:33&#43;00:00">
  

  

  


</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >
  
    
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MPFRNJ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    
  

<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">MarcusRB</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Barra de navegación">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#about">
            
            <span>Inicio</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#publications_selected">
            
            <span>Servicios</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#posts">
            
            <span>Blog</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#publications">
            
            <span>Recursos</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#teaching">
            
            <span>Formación</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#contact">
            
            <span>Contactos</span>
            
          </a>
        </li>

        
        

      

        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">[Guía] Mediciones de click desde un iframe con Google Tag Manager</h1>

  

  
    

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="MarcusRB">
  </span>
  

  <span class="article-date">
    
    <meta content="2018-06-30 08:26:33 &#43;0000 &#43;0000" itemprop="datePublished">
    <time datetime="2018-06-30 08:26:33 &#43;0000 &#43;0000" itemprop="dateModified">
      Jun 30, 2018
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="MarcusRB">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    7 min de lectura
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/guia-mediciones-de-click-desde-un-iframe-con-google-tag-manager/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/categories/tag-manager/">Tag Manager</a>
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=%5bGu%c3%ada%5d%20Mediciones%20de%20click%20desde%20un%20iframe%20con%20Google%20Tag%20Manager&amp;url=https%3a%2f%2fwww.marcusrb.com%2fguia-mediciones-de-click-desde-un-iframe-con-google-tag-manager%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.marcusrb.com%2fguia-mediciones-de-click-desde-un-iframe-con-google-tag-manager%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.marcusrb.com%2fguia-mediciones-de-click-desde-un-iframe-con-google-tag-manager%2f&amp;title=%5bGu%c3%ada%5d%20Mediciones%20de%20click%20desde%20un%20iframe%20con%20Google%20Tag%20Manager"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fwww.marcusrb.com%2fguia-mediciones-de-click-desde-un-iframe-con-google-tag-manager%2f&amp;title=%5bGu%c3%ada%5d%20Mediciones%20de%20click%20desde%20un%20iframe%20con%20Google%20Tag%20Manager"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=%5bGu%c3%ada%5d%20Mediciones%20de%20click%20desde%20un%20iframe%20con%20Google%20Tag%20Manager&amp;body=https%3a%2f%2fwww.marcusrb.com%2fguia-mediciones-de-click-desde-un-iframe-con-google-tag-manager%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      

<h2 id="un-post-sobre-la-medición-de-eventos-cuales-clicks-conversiones-formularios-transacciones-desde-un-iframe-con-google-tag-manager">Un post sobre la medición de eventos, cuales clicks, conversiones, formularios, transacciones desde un iframe con Google Tag Manager.</h2>

<p>Seguramente ya te puesto a buscar y rebuscar sin éxito, o directamente pedir ayuda a un desarrollador.</p>

<p>Es lo mismo que me ha pasado a mí en más de una ocasión, hasta encontrar con varias respuestas y opciones, y gracias a Lunametrics, Simo Avaha y Measureschool, finalmente yo también puedo redactar un post sobre la medición de eventos, cuales clicks, conversiones, formularios, transacciones desde un iframe con Google Tag Manager a Google Analytics o pixel de terceros.</p>

<p><strong>OJO!</strong> Esta guía funciona solo si tienes acceso al sitio web tanto propietario que del iframe, en tal caso, no es posible realizarlo (de momento!)</p>

<p><strong>Check 1.</strong> No tengo acceso al módulo o al sitio web IFRAME. Lo siento, esta guía no es para ti.</p>

<p><strong>Check 2.</strong> Tengo acceso al módulo o al sitio web IFRAME (sigues adelante)</p>

<p>&nbsp;</p>

<h3 id="comprobaciones-del-contenedor-de-google-tag-manager">Comprobaciones del contenedor de Google Tag Manager</h3>

<p>Para la prueba de su correcto funcionamiento, estoy realizando el test desde un sitio web propio, un iframe interno para el mismo dominio. Más adelante veremos con uno externo y tener en consideración USER-id y CrossDomain. La idea es de registrar click o eventos: enlaces, llamadas, formularios o todo lo que podría registrar como tal y enviarlo a Google Analytics.</p>

<p>Diferenciamos así el <strong>iframeParent</strong> (el padre o el principal) y el <strong>iframeChild</strong> (el hijo o el huésped).</p>

<p>Aquí una imagen del <strong>Parent:</strong></p>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.00.43.png" target="_blank"><img class="aligncenter size-large wp-image-657" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.00.43-1024x489.png" alt="iframe parent o iframe padre" width="1024" height="489" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.00.43-1024x489.png 1024w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.00.43-300x143.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.00.43-768x367.png 768w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.00.43-260x124.png 260w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.00.43-50x24.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.00.43-150x72.png 150w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p>y para comprobar el iframe <strong>Child, </strong>tecla de ratón derecho y como la imagen:</p>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.01.39.png" target="_blank"><img class="aligncenter size-full wp-image-658" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.01.39.png" alt="iframe contenedor child" width="993" height="630" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.01.39.png 993w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.01.39-300x190.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.01.39-768x487.png 768w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.01.39-230x146.png 230w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.01.39-50x32.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.01.39-118x75.png 118w" sizes="(max-width: 993px) 100vw, 993px" /></a></p>

<p>&nbsp;</p>

<p>Ahora necesitaremos los accesos a los dos contenedores de Google Tag Manager:</p>

<ul>
<li>Contenedor GTM <strong>Parent</strong></li>
<li>Contenedor GTM <strong>Child</strong></li>
</ul>

<p>Este último en particular va a ser especial, porque realmente necesitaremos darle unas directrices y unos códigos diferentes al resto que ya tenemos en nuestro principal.</p>

<p>&nbsp;</p>

<h3 id="pasos-para-el-contenedor-google-tag-manager-child">Pasos para el contenedor Google Tag Manager CHILD</h3>

<p>Una vez creado el contenedor de Google Tag Manager para el iframe, el Child, lo implementamos como siempre solo en el iframe, sin que le pongamos etiquetas de terceros, ni Google Analytics, ya tendrá el suyo probablemente, luego, subiremos este archivo <em>.json</em> que a continuación explicaré a que sirve.</p>

<p>ARCHIVO JSON</p>

<p>Este archivo, como el resto de <a href="https://www.marcusrb.com/recetas-de-google-tag-manager/" target="_blank" rel="noopener">&#8220;recetas&#8221; de Google Tag Manager</a>, está en formato JSON, o resumido, un contenedor con elementos, para importar directamente en nuestro Google Tag Manager, sin tener que reescribir nuevamente todas las etiquetas y códigos. Con este en particular, para un contenedor nuevo no tenemos que sobrescribir nada (si el contenedor es nuevo, no hace falta). Si ya tenemos elementos en el contenedor, entonces no tenemos que seleccionar la opción de sobrescribir.</p>

<p>Una vez importado el archivo entramos en la etiqueta <strong>SENDER &#8211; postMessage </strong>para sus comprobaciones.</p>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.09.31.png" target="_blank"><img class="aligncenter size-large wp-image-660" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.09.31-1024x630.png" alt="muestra código iframe" width="1024" height="630" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.09.31-1024x630.png 1024w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.09.31-300x185.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.09.31-768x473.png 768w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.09.31-237x146.png 237w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.09.31-50x31.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.09.31-122x75.png 122w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-20.09.31.png 1139w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p>&nbsp;</p>

<p>Vamos a explicar en detalle esta etiqueta personalizada:</p>

<ul>
<li>ejecuta una declaración <strong>try&#8230;catch </strong>, tal como indica el nombre, es un bloque de instrucciones para intentar (<strong>try) </strong>y en caso de excepción <strong>(catch) </strong>devuelve el error en la consola de desarrollador de nuestro navegador. <a href="https://developer.mozilla.org/es/docs/Web/JavaScript/Referencia/Sentencias/try...catch" target="_blank" rel="noopener">Más info</a></li>
<li>Asignamos la variable <strong>postObject </strong>del tipo <em>JSON.stringify</em>, este método convierte un valor dado en javascript a una cadena  <strong>JSON</strong>, opcionalmente reemplaza valores si es especificada la función <code>&lt;strong&gt;&lt;em&gt;de reemplazo&lt;/em&gt;&lt;/strong&gt;</code>, o si se especifican las propiedades mediante un array de reemplazo.</li>
<li>de un lado tenemos el <strong>event </strong>y lanza el propio iframe, así que como nombre he puesto <em>iframeACCION </em>(sustituye ACCION por el tipo de evento, form, link, click, video, transaction, etc), y del otro lado tengo <strong>link </strong>en mi caso estoy lanzado eventos de tipo <em>enlace</em> y le asigno un nombre, una variable, cualquier cosa que quieras que mida.

<ul>
<li>Ej. {{CLICK URL}} &#8211; {{CLICK TEXT}}, devolverá la ruta completa del click sobre este enlace y el nombre del texto ancla.</li>
</ul></li>
<li>mandamos el todo a la ventana principal con el método <strong>parent.postMessage() </strong>donde activa la comunicación entre la pantalla origen y destino, y que le enviamos los siguientes datos:

<ul>
<li>la variable <strong>postObject</strong></li>
<li>la ruta y dominio <strong>huésped</strong></li>
</ul></li>
</ul>

<p>&nbsp;</p>

<h4 id="configuración-eventos-child">Configuración Eventos Child</h4>

<p>Ahora bien. Podemos proceder con la configuración de los eventos en este contenedor <strong>iframeChild, </strong>yo voy a seleccionar por ejemplo, el vinculo a la llamada telefónica, mejor dicho aquellos usuarios que hará click en el enlace <strong>TELÉFONO</strong></p>

<p>Activamos las variables integradas (en el caso sea nuevo el contenedor es importante tenerlos activos):</p>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.35.13.png" target="_blank"><img class="aligncenter size-large wp-image-663" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.35.13-1024x844.png" alt="variables integradas google tag manager" width="1024" height="844" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.35.13-1024x844.png 1024w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.35.13-300x247.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.35.13-768x633.png 768w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.35.13-177x146.png 177w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.35.13-50x41.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.35.13-91x75.png 91w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.35.13.png 1035w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p>&nbsp;</p>

<p>Modifico algunos parámetros de la etiqueta personalizada anterior dejándola así con su activador correspondiente para las llamadas telefónicas:</p>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.36.52.png" target="_blank"><img class="aligncenter size-large wp-image-664" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.36.52-1024x704.png" alt="etiqueta iframe personalizada de tag manager" width="1024" height="704" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.36.52-1024x704.png 1024w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.36.52-300x206.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.36.52-768x528.png 768w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.36.52-212x146.png 212w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.36.52-50x34.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.36.52-109x75.png 109w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.36.52.png 1179w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p>Los cambios efectuados son solamente descriptivos, además de asignarle la ruta donde tengo alojado el iframe.</p>

<p>Guardamos, creamos versión y Publicamos. Hasta aquí finalizado el proceso de configuración del iframe mismo.</p>

<p>&nbsp;</p>

<h3 id="pasos-para-el-contenedor-google-tag-manager-parent">Pasos para el contenedor Google Tag Manager PARENT</h3>

<p>Ahora toca al contenedor padre tener que realizar unas cuántas configuraciones. Primero vamos a importar este archivo json:</p>

<p>Recuerda d no modificar el resto de etiquetas o elementos de nuestro contenedor, con lo cuál le damos a NO SOBRESCRIBIR el resto de elementos.</p>

<p>Lo que vamos a tener son dos elementos importados:</p>

<ul>
<li>etiqueta personalizada con uno script de llamadas de parámetros <strong>LISTENER</strong></li>
<li>una variable tipo dataLayer que importa el valor del iframe <strong>EVENT iframePhoneClick</strong>, justo para seguir el ejemplo anterior</li>
</ul>

<p>El script es un poco largo de detallar pero básicamente tiene unos puntos importantes a subrayar:</p>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.42.06.png" target="_blank"><img class="aligncenter size-large wp-image-665" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.42.06-1024x522.png" alt="listener de la pagina iframe parent" width="1024" height="522" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.42.06-1024x522.png 1024w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.42.06-300x153.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.42.06-768x392.png 768w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.42.06-260x133.png 260w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.42.06-50x26.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.42.06-147x75.png 147w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.42.06.png 1539w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p>&nbsp;</p>

<ul>
<li>con el <strong>addEvent </strong>enviamos el mensaje desde el iFrame hacía el Parent</li>
<li>declaramos la variable <strong>data</strong> con el _JSON.parse, _un comunicador entre las dos partes, y así el dataLayer</li>
<li>Ejecutamos el <strong>dataLayer</strong> en el caso existan eventos</li>
<li>definición de <strong>eventos</strong> con el <em>addEventListener</em></li>
</ul>

<p>&nbsp;</p>

<h4 id="configuración-eventos-parent">Configuración Eventos Parent</h4>

<p>Así creado no tenemos que realizar nada más que otras dos acciones.</p>

<ol>
<li>Asignarle un <strong>activador</strong>, una simple Página Vista de la página de donde se ejecuta el evento, en mi caso /<em>event.html</em></li>
</ol>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.46.48.png" target="_blank"><img class="aligncenter size-large wp-image-666" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.46.48-1024x256.png" alt="pagina vista activador iframe" width="1024" height="256" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.46.48-1024x256.png 1024w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.46.48-300x75.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.46.48-768x192.png 768w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.46.48-260x65.png 260w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.46.48-50x12.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.46.48-150x37.png 150w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.46.48.png 1165w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p>&nbsp;</p>

<p style="padding-left: 30px;">
  2. Creamos el evento para <strong>Google Analytics </strong>de este modo:
</p>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.47.50.png" target="_blank"><img class="aligncenter size-full wp-image-667" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.47.50.png" alt="evento google analytics llamada" width="700" height="573" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.47.50.png 700w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.47.50-300x246.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.47.50-178x146.png 178w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.47.50-50x41.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.47.50-92x75.png 92w" sizes="(max-width: 700px) 100vw, 700px" /></a></p>

<p>&nbsp;</p>

<p>Asignamos:</p>

<ul>
<li><em>Categoria</em>: lo que queramos desde el iframe, en mi caso <strong>childPhone</strong></li>
<li>_Acción: _yo he puesto la página donde se ha ejecutado la acción, o poner lo que sigue en Etiqueta</li>
<li>_Etiqueta: _alternativamente a la anterior, utilizar una variable <strong>dataLayer </strong>del mensaje desde el iframe creado anteriormente, <strong>postMessageData</strong>

<ul>
<li>OJO, porque la variable ahora tiene dos partes, la primera _postMessageData _y el segundo parámetro del script del child, adivinista cuál? sí, es <em>Link</em></li>
</ul></li>
</ul>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.52.35.png" target="_blank"><img class="aligncenter size-full wp-image-668" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.52.35.png" alt="dataLayer para informaciones" width="605" height="332" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.52.35.png 605w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.52.35-300x165.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.52.35-260x143.png 260w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.52.35-50x27.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.52.35-137x75.png 137w" sizes="(max-width: 605px) 100vw, 605px" /></a></p>

<p>Esta variable nos sirve como &#8220;comunicador&#8221; de la información que teníamos creada desde el <strong>CHILD </strong>con el tipo de click, form o transaction, lo que sea, básicamente si dentro del Child teníamos una variable de {{Click URL}} aquí me enviará la respuesta.</p>

<p style="padding-left: 30px;">
  3. Ahora toca al <strong>activador</strong> del evento de Google Analytics:
</p>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.54.56.png" target="_blank"><img class="aligncenter size-full wp-image-669" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.54.56.png" alt="evento personalizado iframe child" width="605" height="343" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.54.56.png 605w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.54.56-300x170.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.54.56-258x146.png 258w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.54.56-50x28.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.54.56-132x75.png 132w" sizes="(max-width: 605px) 100vw, 605px" /></a></p>

<p>Este activador va a ser una llamada al <strong>Evento Personalizado </strong>del _iframeChild, _sí sí, lo que teníamos declarado en el otro, exactamente cuando se ejecuta el evento, entonces DISPARA nuestra etiqueta.</p>

<p>Guardamos, creamos versión y Publicamos.</p>

<p>FIN!</p>

<p>&nbsp;</p>

<h3 id="testing-de-eventos-en-iframe">Testing de eventos en iFrame</h3>

<p>Vamos a realizar la dinámica y ver como queda el todo con las siguientes imágenes de vista previa y debug:</p>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.58.22.png" target="_blank"><img class="aligncenter size-large wp-image-670" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.58.22-1024x619.png" alt="debug y vista previa iframe tag manager" width="1024" height="619" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.58.22-1024x619.png 1024w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.58.22-300x181.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.58.22-768x464.png 768w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.58.22-241x146.png 241w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.58.22-50x30.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.58.22-124x75.png 124w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.58.22.png 1505w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p>&nbsp;</p>

<p>Verificación del evento ejecutado y dispara la etiqueta a Google Analytics</p>

<p>&nbsp;</p>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.59.00.png" target="_blank"><img class="aligncenter size-full wp-image-671" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.59.00.png" alt="disparador evento personalizado analytics" width="850" height="544" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.59.00.png 850w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.59.00-300x192.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.59.00-768x492.png 768w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.59.00-228x146.png 228w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.59.00-50x32.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-21.59.00-117x75.png 117w" sizes="(max-width: 850px) 100vw, 850px" /></a></p>

<p>&nbsp;</p>

<p>Tiempo real en Google Analytics y Prueba Terminada!</p>

<p><a href="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-22.00.09.png" target="_blank"><img class="aligncenter size-large wp-image-672" src="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-22.00.09-1024x395.png" alt="tiempo real google analytics iframe" width="1024" height="395" srcset="https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-22.00.09-1024x395.png 1024w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-22.00.09-300x116.png 300w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-22.00.09-768x296.png 768w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-22.00.09-260x100.png 260w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-22.00.09-50x19.png 50w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-22.00.09-150x58.png 150w, https://www.marcusrb.com/img/2018/06/Captura-de-pantalla-2018-06-29-a-las-22.00.09.png 1332w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<h3 id="conclusiones">Conclusiones</h3>

<p>Hemos realizado el primer test sencillo de como enviar eventos desde un marco (iframe) dentro de un sitio web, estamos hablando de uno básico, mismo dominio y pocos eventos de click en enlaces o un formulario.</p>

<p>Imagina ahora de tener que implantar uno snippet externo de booking, sí, propio para las reservas hoteleras que tanto se utilizan o utilizar EventBrite, o compras de tickets de eventos.</p>

<p>Bien esta parte llevaría exactamente los mismos pasos anteriores más dos configuraciones más que actualizar más adelante:</p>

<ol>
<li>CLIENT-ID y COOKIE: la idea es tener la misma sesión abierta en ambos sitios sin perder el usuario logueado, ni tener que a contabilizar más sesiones por usuario (y reconocerlo sobre todo)</li>
<li>CROSS DOMAIN o multidominio: el tener que pasar por dos <em>sitios web diferentes</em>, parece raro pero realmente son dos páginas enmarcadas en una sola, pero con dos dominios distintas, entonces necesitaríamos utilizar la configuración también de esta, así como su exclusión como referral en Google Analytics.</li>
</ol>

<p>Hasta aquí es todo, cuéntame tu experiencia que tal fue o se has buscado algún otro atajo con los iframe</p>

<p>&nbsp;</p>

    </div>

    


<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/analytics-iframe-sitio-web/">analytics iframe sitio web</a>
  
  <a class="badge badge-light" href="/tags/eventos-iframe-gtm/">eventos iframe gtm</a>
  
  <a class="badge badge-light" href="/tags/tag-manager/">tag manager</a>
  
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Relacionado</h3>
      <ul>
        
        <li><a href="/guia-cookiebot-en-gtm-y-estar-protegido-de-la-nueva-rgpd/">[Guía] Cookiebot en GTM y estar protegido de la nueva RGPD</a></li>
        
        <li><a href="/guia-implementar-comercio-electronico-en-google-tag-manager-web/">[Guía] Implementar Comercio electrónico en Google Tag Manager para sitios web</a></li>
        
      </ul>
    </div>
    

    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "marcusRB" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

<div class="container">
  <footer class="site-footer">
  

  <p class="powered-by">
    &copy; 2018 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Citar</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copiar
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Descargar
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
      

      
      
    

    <script src="/js/hugo-academic.js"></script>
    

    
    

    
    
    
    <script id="dsq-count-scr" src="//marcusRB.disqus.com/count.js" async></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "",
        'results': "",
        'no_results': ""
      };
      const content_type = {
        'post': "Posts",
        'project': "Proyectos",
        'publication' : "Publicaciones",
        'talk' : "Conferencias"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    <script src="/js/search.js"></script>
    

    
    

  </body>
</html>

